# 可信评估原始测评报告流程计划（更新版）

## 1. 流程概述

本更新版流程计划基于每题独立评估逻辑，通过多个评估器对每道题进行独立评分，然后比较共识和分歧，对分歧较大的题目引入更多模型进行评估，直至达成共识。

## 2. 评估器组织上下文策略

### 2.1 每题独立评估模式
在每题独立评估模式下，评估器为每道题创建独立的上下文：

- **独立上下文构建**：每道题构建专属评估提示，包含：
  - 题目维度信息（外向性、宜人性等）
  - 具体问题描述
  - 场景背景
  - AI代理的回答
  - 明确的评分标准（1-3-5分制）

- **临时文件处理**：系统为每道题创建独立的临时评估文件：
  ```
  temp_segments/
  └── {filename}/
      ├── question_001.json
      ├── question_002.json
      └── ...
  ```

### 2.2 2题分段评估模式
在2题分段评估模式下，评估器为每2道题创建联合上下文：

- **联合上下文构建**：每组2题构建统一评估提示，包含两道题的完整信息
- **临时文件处理**：系统为每组2题创建联合临时评估文件：
  ```
  temp_segments/
  └── {filename}/
      ├── segment_001.json  (包含question_1和question_2)
      ├── segment_002.json  (包含question_3和question_4)
      └── ...
  ```

## 3. 详细评估流程

### 3.1 初始评估阶段

1. **文件解析**
   - 读取原始测评报告JSON文件
   - 提取所有问题及其回答

2. **评估模式选择**
   - 用户可选择三种模式：
     - 分段评估模式（原有功能）
     - 每题独立评估模式（新增功能）
     - 2题分段评估模式（新增功能）

3. **多评估器分配**
   - 选择前3个可用评估器进行初始评估
   - 评估器包括云模型（如Gemini, Qwen等）和本地模型（如Ollama）

### 3.2 每题独立评估流程

1. **独立评估**
   - 对每道题创建独立评估提示
   - 3个评估器并行评估每道题
   - 评估内容包括Big5五个维度的1-3-5分制评分

2. **评分聚合**
   - 计算每个维度的中位数得分
   - 生成每题的最终评分

3. **一致性检查**
   - 计算评估器间的一致性
   - 识别评分差异大于1分的争议题目

### 3.3 2题分段评估流程

1. **分段组合**
   - 将题目按顺序每2题为一组进行组合
   - 为每组创建联合评估提示

2. **联合评估**
   - 3个评估器并行评估每组2题
   - 评估内容包括：
     - 组合评分（对2题的整体评估）
     - 单题评分（对每道题的独立评估）

3. **评分聚合**
   - 计算每组的中位数得分
   - 提取每题的独立评分进行聚合

### 3.4 争议解决机制

1. **争议识别**
   - 自动识别评分差异大于1分的题目
   - 标记存在争议的评估结果

2. **多轮争议解决**
   - **第1轮**：引入2个额外评估器重新评估争议题目
   - **第2轮**：如仍有争议，再引入2个额外评估器
   - **第3轮**：最多进行3轮争议解决

3. **多数决策原则**
   - 使用中位数评分作为最终得分
   - 确保评分的可信度和一致性

### 3.5 信度验证

1. **Cronbach's Alpha计算**
   - 计算各维度的内部一致性系数
   - 验证评分的可靠性

2. **评估者间信度**
   - 计算不同评估器间的一致性
   - 确保评分的稳定性

### 3.6 人格分析

1. **大五人格分析**
   - 基于最终评分生成详细的人格特征描述

2. **MBTI类型推断**
   - 将Big5评分映射到16种MBTI类型

3. **贝尔宾团队角色**
   - 识别个体在团队中的角色倾向

## 4. 输出结果

### 4.1 评估报告
- 包含所有题目的评分结果
- 一致性分析报告
- 信度验证结果
- 争议解决记录
- 人格分析结果

### 4.2 临时文件
- 保存每道题或每组题的详细评估信息
- 便于后续的争议解决和复用

### 4.3 完成文件管理
- 原始文件移动到已完成目录
- 评估结果保存到指定输出目录

## 5. 技术特点

### 5.1 真实评估保证
- 每道题的评分都基于真实的大模型API调用
- 确保评估结果的真实性和可信度

### 5.2 多模型验证
- 使用多个模型进行独立评估
- 提高评分的准确性和可靠性

### 5.3 自适应处理
- 根据题目难度和模型能力选择合适的评估模式
- 动态调整评估策略

### 5.4 完整测试覆盖
- 所有功能均通过TDD测试驱动开发
- 确保系统的稳定性和正确性

## 6. 使用建议

### 6.1 评估模式选择
- **每题独立评估**：适用于需要高精度评分的场景
- **2题分段评估**：适用于平衡精度和效率的场景
- **分段评估**：适用于处理大量题目的场景

### 6.2 模型配置
- 优先使用响应速度快、准确度高的模型
- 合理配置云模型和本地模型的比例

### 6.3 性能优化
- 根据题目复杂度选择合适的分段大小
- 控制并发评估的数量以避免API限流